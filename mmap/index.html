<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Marauder's Map</title>
	<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=true&amp;libraries=places"></script>
	</script>
	<link rel="stylesheet" href="style.css">
	<script>
		function initialize() {
			// standard tufts coordinates
			var init_lat = 42.4060269;
	    	var init_lng = -71.118939;

	    	// set the map options (zoom and location)
			var mapOptions = {
				center: {lat: init_lat, lng: init_lng},
				zoom: 12
			};

			// create the map
			var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

			xhr = new XMLHttpRequest();

		    // open connection with MBTA Redline (JSON file)
		    xhr.open('post', 'http://chickenofthesea.herokuapp.com/sendLocation', true);

			if (navigator.geolocation){
				pinLocation();
			} else {
				console.log("Error in Navigator")
			}

			function pinLocation() {
				navigator.geolocation.getCurrentPosition(function(position) {
					var marker = new google.maps.Marker({
					    position: {lat: position.coords.latitude, lng: position.coords.longitude},
					    map: map
					});
				});
			}

		    // if change in readystate, update pins
		    xhr.onreadystatechange = function() {
		    	if (xhr.readyState == 4 && xhr.status == 200) {
		    		data = JSON.parse(xhr.responseText);
		    		console.log(data);

		    	} else if (xhr.readyState == 4) {
		    		console.log('There was an error retrieving the data.');
		    	}
		    };
		    xhr.send();

		}

		// call google map on page load
		google.maps.event.addDomListener(window, 'load', initialize);
	</script>
</head>
<body>
	<div id="map-canvas"></div>
</body>
</html>